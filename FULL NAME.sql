SELECT PlayerFullName  FROM FIFA
SELECT LONGNAME FROM FIFA

--EXTRACT FULL NAME FROM PLAYERURL AND LONGNAME

SELECT SUBSTRING(PLAYERURL,33, LEN(LONGNAME)+2)
FROM FIFA

--UPDATE TABLE
ALTER TABLE FIFA
ADD PlayerFullName  varchar(100)

update FIFA
set PlayerFullName = SUBSTRING(PLAYERURL,33, LEN(LONGNAME)+2)

--REPLACE AND USED CASE STATEMENT TO REMOVE '/' AND THE LIKES
SELECT PlayerFullName,REPLACE(UPPER(CASE
						WHEN CHARINDEX('/', PlayerFullName) > 0
						THEN SUBSTRING(PlayerFullName,1,CHARINDEX('/',PlayerFullName)-1)
						ELSE PlayerFullName
						END),'-',' ')
FROM FIFA
-- WE UPDATE TABLE
UPDATE FIFA
SET LONGNAME = REPLACE(UPPER(CASE
						WHEN CHARINDEX('/', PlayerFullName) > 0
						THEN SUBSTRING(PlayerFullName,1,CHARINDEX('/',PlayerFullName)-1)
						
						ELSE PlayerFullName
						END),'-',' ')
--NOTICE RONALDO WAS NOT FULLY SPELT SO WE USED CASE SATETMENT  TO CORRECT IT AND UPDATE TABLE
UPDATE FIFA
SET  LONGNAME=CASE		
					WHEN LONGNAME = ' RONALDO DOS SANTOS AVEIRO' THEN 'CRISTIANO RONALDO DOS SANTOS AVEIRO'
					ELSE LONGNAME
					END
FROM FIFA

SELECT LONGNAME FROM FIFA

--ANOTHER METHOD BY EXTRACTING PLAYERFULLNAME FROM URL ONLY
SELECT SUBSTRING(PLAYERURL,33, LEN(playerUrl))
FROM FIFA

-- ADD AND UPDATE TABLE
ALTER TABLE FIFA
ADD [PlayerFullName] VARCHAR(100)

UPDATE FIFA
SET [PlayerFullName] = SUBSTRING(PLAYERURL,33, LEN(playerUrl))

--REPLACE /210006/ WITH ''

SELECT REPLACE(SUBSTRING(PLAYERURL,33, LEN(playerUrl)+1),'/210006/','')
FROM FIFA

--THEN WE REPLACE '-' WITH ' ' SPACE AND MAKE EVERY THING UPPER CASE

SELECT UPPER(REPLACE(REPLACE(SUBSTRING(PLAYERURL,33, LEN(playerUrl)+1),'/210006/',''),'-',' '))
FROM FIFA

-- UPDATE COLUMN
UPDATE FIFA
SET [PlayerFullName] = UPPER(REPLACE(REPLACE(SUBSTRING(PLAYERURL,33, LEN(playerUrl)+1),'/210006/',''),'-',' '))

--ALSO RONALDO WAS NOT FULLY SPELT SO WE USED CASE SATETMENT  TO CORRECT IT AND UPDATE COLUMN

UPDATE FIFA
SET [PlayerFullName] =CASE		
					WHEN [PlayerFullName] = ' RONALDO DOS SANTOS AVEIRO' THEN 'CRISTIANO RONALDO DOS SANTOS AVEIRO'
					ELSE [PlayerFullName]
					END
--FROM FIFA

SELECT [PlayerFullName] FROM  FIFA


